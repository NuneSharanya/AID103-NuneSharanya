<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CropGuard AI</title>

<style>
body {
    margin: 0;
    font-family: "Segoe UI", Arial, sans-serif;

    background-image: url("137521.jpg");
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;

    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
}

.card {
    background: rgba(255, 255, 255, 0.92);
    width: 420px;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
    backdrop-filter: blur(6px);
}



.header {
    text-align: center;
    margin-bottom: 20px;
}

.header h1 {
    margin: 0;
    color: #178740;
}

input[type="file"] {
    width: 100%;
    margin: 15px 0;
}

button {
    width: 100%;
    padding: 12px;
    background-color: #178740;
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 15px;
    cursor: pointer;
}

.result {
    margin-top: 20px;
    padding: 15px;
    background: #f4f6fb;
    border-radius: 6px;
    display: none;
}
</style>
</head>

<body>

<div class="card">
    <div class="header">
        <h1>üå± CropGuard AI</h1>
        <p>AI Disease Detection System</p>
    </div>

    <input type="file" id="imageInput" accept="image/*">

    <!-- IMPORTANT: type="button" -->
    <button type="button" onclick="analyzeCrop()">Analyze Crop</button>

    <div class="result" id="resultBox">
        <p><b>Disease:</b> <span id="disease"></span></p>
        <p><b>Confidence:</b> <span id="confidence"></span></p>
        <p><b>Recommendation:</b> <span id="recommendation"></span></p>
    </div>
</div>

<script>
async function analyzeCrop() {
    console.log(" Button clicked");

    const input = document.getElementById("imageInput");

    if (!input.files.length) {
        alert("Please select an image");
        return;
    }

    const formData = new FormData();
    formData.append("file", input.files[0]);

    document.getElementById("resultBox").style.display = "block";
    document.getElementById("disease").innerText = "Processing...";
    document.getElementById("confidence").innerText = "";
    document.getElementById("recommendation").innerText = "";

    try {
        const response = await fetch("http://127.0.0.1:5000/predict", {
            method: "POST",
            body: formData
        });

        console.log(" Response status:", response.status);

        const data = await response.json();
        console.log(" Data:", data);

        document.getElementById("disease").innerText = data.disease || "N/A";
        document.getElementById("confidence").innerText = data.confidence || "N/A";
        document.getElementById("recommendation").innerText = data.recommendation || "N/A";

    } catch (err) {
        console.error("‚ùå Fetch error:", err);
        document.getElementById("disease").innerText = "Backend error";
        document.getElementById("recommendation").innerText =
            "Check if backend is running";
    }
}
</script>

</body>
</html>